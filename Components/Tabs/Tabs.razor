@namespace TablerForNet.Components

<div class="card">
    <CascadingValue Value="@this">
        <div class="card-header">
            <ul class="nav nav-tabs card-header-tabs @(FullWidthTabs ? "nav-fill": "")" data-toggle="tabs">
                @ChildContent
            </ul>
        </div>
    </CascadingValue>

    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane active show">
                <div> @ActiveTab?.ChildContent</div>
            </div>
        </div>
    </div>
</div>

@code {

    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public bool FullWidthTabs { get; set; } = false;

    public Tab? ActiveTab { get; private set; }

    public async Task AddTab(Tab tab)
    {
        if (ActiveTab == null)
        {
            await SetActivateTab(tab);
        }
    }

    public async Task RemoveTab(Tab tab)
    {
        if (ActiveTab == tab)
        {
            await  SetActivateTab(null);
        }
    }

    public async Task SetActivateTab(Tab? tab)
    {
        if (tab == null)
        {
            ActiveTab = null;
            await InvokeAsync(StateHasChanged);
            return;
        }

        if (ActiveTab != tab)
        {
            ActiveTab = tab;
            await InvokeAsync(StateHasChanged);
        }
    }
}